define(["underscore","jquery","services/suluredirect/redirect-manager","text!./form.html"],function(a,b,c,d){var e={formSelector:"#redirect-routes-form"};return{defaults:{templates:{form:d},translations:{source:"sulu_redirect.source",sourceHost:"sulu_redirect.source-host",target:"sulu_redirect.target",conflict:"sulu_redirect.errors.conflict"}},layout:{content:{width:"fixed",leftSpace:!0,rightSpace:!0}},initialize:function(){this.render(),this.bindDomEvents(),this.bindCustomEvents()},render:function(){this.$el.html(this.templates.form({translations:this.translations,data:this.data})),this.form=this.sandbox.form.create(e.formSelector),this.form.initialized.then(function(){this.sandbox.form.setData(e.formSelector,this.data||{})}.bind(this))},bindDomEvents:function(){this.$el.find("input, textarea").on("keypress",function(){this.sandbox.emit("sulu.tab.dirty")}.bind(this))},bindCustomEvents:function(){this.sandbox.on("sulu.tab.save",this.save.bind(this)),this.sandbox.on("sulu_redirect.statusCode.changed",this.statusCodeChanged.bind(this))},save:function(a){if(this.sandbox.form.validate(e.formSelector)){var b=this.sandbox.util.extend(!1,{},a,this.sandbox.form.getData(e.formSelector));return c.save(b).then(function(a){this.sandbox.emit("sulu.tab.saved",a)}.bind(this)).fail(function(a){switch(a.status){case 409:this.sandbox.emit("sulu.labels.error.show",this.translations.conflict);break;default:this.sandbox.emit("sulu.labels.error.show")}this.sandbox.emit("sulu.tab.dirty")}.bind(this))}},statusCodeChanged:function(a){this.data=this.sandbox.util.extend(!1,{},a,this.sandbox.form.getData(e.formSelector)),this.render()},loadComponentData:function(){return this.options.data()}}});